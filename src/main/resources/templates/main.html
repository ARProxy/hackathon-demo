<!--<!DOCTYPE html>-->
<!--<html lang="ko" xmlns:th="http://www.thymeleaf.org">-->
<!--<head>-->
<!--    <meta charset="UTF-8">-->
<!--    <title>ë©”ì¸ í˜ì´ì§€</title>-->
<!--    <meta name="viewport" content="width=device-width, initial-scale=1">-->
<!--    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">-->
<!--    <style>-->
<!--        body { background:#fff; font-family: 'Noto Sans KR', sans-serif; }-->
<!--        header {-->
<!--            display:flex; justify-content:space-between; align-items:center;-->
<!--            padding: 1rem; border-bottom:1px solid #ddd;-->
<!--        }-->
<!--        .logo { font-size:1.2rem; font-weight:bold; color:#0d6efd; }-->
<!--        .user-info { display:flex; align-items:center; }-->
<!--        .user-info img {-->
<!--            width:32px; height:32px; border-radius:50%; margin-right:8px;-->
<!--        }-->
<!--        .main-content {-->
<!--            padding: 2rem 1rem;-->
<!--            text-align:center;-->
<!--        }-->
<!--    </style>-->
<!--</head>-->
<!--<body>-->
<!--<header>-->
<!--    &lt;!&ndash; ì™¼ìª½ ë¡œê³  &ndash;&gt;-->
<!--    <div class="logo">Cellonine</div>-->

<!--    &lt;!&ndash; ì˜¤ë¥¸ìª½ ì‚¬ìš©ì í”„ë¡œí•„ &ndash;&gt;-->
<!--    <div class="user-info">-->
<!--        <img th:src="${user.profile_image_url}" alt="í”„ë¡œí•„">-->
<!--        <span th:text="${user.nickname}">ì‚¬ìš©ì</span>-->
<!--    </div>-->
<!--</header>-->

<!--<main class="main-content">-->
<!--    <h2>5000ë§Œ ëŒ€í•œë¯¼êµ­ êµ­ë¯¼ì˜ ì¼ìƒì„ ì‘ì›í•©ë‹ˆë‹¤.</h2>-->
<!--    <p>ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ ì„±ê³µ ğŸ‰</p>-->
<!--</main>-->
<!--</body>-->
<!--</html>-->
<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>ë©”ì¸ í˜ì´ì§€ - ë‚´ ì§€ì—­ ì¬ë‚œì§€ì›ê¸ˆ ì°¾ê¸°</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            background-color: #f8f9fa; /* ë¶€ë“œëŸ¬ìš´ ë°°ê²½ìƒ‰ */
            font-family: 'Noto Sans KR', sans-serif;
        }
        header {
            display:flex; justify-content:space-between; align-items:center;
            padding: 1rem 2rem;
            border-bottom:1px solid #dee2e6;
            background-color: #ffffff;
            box-shadow: 0 2px 4px rgba(0,0,0,.05);
        }
        .logo { font-size:1.4rem; font-weight:bold; color:#0d6efd; }
        .user-info { display:flex; align-items:center; }
        .user-info img {
            width:36px; height:36px; border-radius:50%; margin-right:10px;
            border: 2px solid #eee;
        }
        .user-info span { font-weight: 500; }
        .main-content {
            padding: 3rem 1rem;
        }
        .search-box {
            max-width: 600px;
            margin: 0 auto;
            background: #fff;
            padding: 2rem;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,.1);
            text-align: center;
        }
        .search-box h2 {
            margin-bottom: 0.5rem;
            font-weight: 700;
            color: #333;
        }
        .search-box p {
            margin-bottom: 1.5rem;
            color: #6c757d;
        }
        .results-container {
            max-width: 700px;
            margin: 2rem auto 0;
            text-align: left;
        }
        .result-card {
            background: #fff;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
        }
        .result-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 16px rgba(0,0,0,.1);
        }
        .result-card h5 {
            color: #0d6efd;
            font-weight: 700;
            margin-bottom: 0.75rem;
        }
        .result-card .agency {
            font-size: 0.9rem;
            color: #6c757d;
            margin-bottom: 1rem;
            font-weight: 500;
        }
        .result-card p {
            font-size: 1rem;
            line-height: 1.6;
            color: #495057;
        }
        .spinner-border {
            width: 3rem;
            height: 3rem;
        }
    </style>
</head>
<body>

<header>
    <div class="logo">Cellonine</div>
    <div class="user-info">
        <img th:src="${user.profile_image_url}" alt="í”„ë¡œí•„">
        <span th:text="${user.nickname}">ì‚¬ìš©ì</span>
    </div>
</header>

<main class="main-content">
    <div class="search-box">
        <h2>ë‚´ ì§€ì—­ ì¬ë‚œì§€ì›ê¸ˆ ì°¾ê¸°</h2>
        <p>ê±°ì£¼ì§€ ì£¼ì†Œë¥¼ ì…ë ¥í•˜ê³  ì§€ì› ê°€ëŠ¥í•œ ì¬ë‚œì§€ì›ê¸ˆì„ í™•ì¸í•˜ì„¸ìš”.</p>

        <div class="input-group mb-3">
            <input type="text" id="address-input" class="form-control" placeholder="ë¨¼ì € ì£¼ì†Œ ê²€ìƒ‰ ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”" readonly>
            <button class="btn btn-outline-secondary" type="button" id="search-address-btn">ì£¼ì†Œ ê²€ìƒ‰</button>
        </div>
        <button class="btn btn-primary w-100" id="find-relief-btn">ì¬ë‚œì§€ì›ê¸ˆ ì¡°íšŒí•˜ê¸°</button>
    </div>

    <div class="results-container mt-4">
        <div id="loading-spinner" class="text-center d-none">
            <div class="spinner-border text-primary" role="status">
                <span class="visually-hidden">Loading...</span>
            </div>
        </div>

        <div id="results-list">
        </div>
    </div>
</main>

<script src="//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
<script>
    // 1. ì£¼ì†Œ ê²€ìƒ‰ ë²„íŠ¼ í´ë¦­ ì‹œ ë‹¤ìŒ ì£¼ì†Œ API í˜¸ì¶œ
    document.getElementById('search-address-btn').addEventListener('click', function () {
        new daum.Postcode({
            oncomplete: function(data) {
                // íŒì—…ì—ì„œ ê²€ìƒ‰ê²°ê³¼ í•­ëª©ì„ í´ë¦­í–ˆì„ë•Œ ì‹¤í–‰í•  ì½”ë“œë¥¼ ì‘ì„±í•˜ëŠ” ë¶€ë¶„.
                document.getElementById('address-input').value = data.address; // ìµœì¢… ì£¼ì†Œê°’ì„ ì…ë ¥ì°½ì— ë„£ìŒ
            }
        }).open();
    });

    // 2. ì¬ë‚œì§€ì›ê¸ˆ ì¡°íšŒí•˜ê¸° ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸
    document.getElementById('find-relief-btn').addEventListener('click', function() {
        const address = document.getElementById('address-input').value;
        if (!address) {
            alert('ì£¼ì†Œë¥¼ ë¨¼ì € ê²€ìƒ‰í•´ì£¼ì„¸ìš”.');
            return;
        }

        // ë¡œë”© ìŠ¤í”¼ë„ˆ ë³´ì´ê¸° ë° ì´ì „ ê²°ê³¼ ì´ˆê¸°í™”
        const loadingSpinner = document.getElementById('loading-spinner');
        const resultsList = document.getElementById('results-list');
        loadingSpinner.classList.remove('d-none');
        resultsList.innerHTML = '';

        // *** ì¤‘ìš” ***
        // ì‹¤ì œë¡œëŠ” ì´ ë¶€ë¶„ì—ì„œ ì„œë²„(ë°±ì—”ë“œ)ë¡œ address ê°’ì„ ë³´ë‚´
        // ê³µê³µ APIë¥¼ í˜¸ì¶œí•˜ê³  ê·¸ ê²°ê³¼ë¥¼ ë°›ì•„ì™€ì•¼ í•©ë‹ˆë‹¤.
        // ì—¬ê¸°ì„œëŠ” ì‹œë®¬ë ˆì´ì…˜ì„ ìœ„í•´ ê°€ì§œ ë°ì´í„°ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.
        fetchDisasterReliefData(address)
            .then(data => {
                loadingSpinner.classList.add('d-none'); // ë¡œë”© ìŠ¤í”¼ë„ˆ ìˆ¨ê¸°ê¸°
                displayResults(data); // ê²°ê³¼ í‘œì‹œ í•¨ìˆ˜ í˜¸ì¶œ
            })
            .catch(error => {
                loadingSpinner.classList.add('d-none'); // ì—ëŸ¬ ì‹œì—ë„ ìŠ¤í”¼ë„ˆ ìˆ¨ê¸°ê¸°
                resultsList.innerHTML = `<div class="alert alert-danger">ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.</div>`;
                console.error('Error fetching data:', error);
            });
    });

    // 3. (ì‹œë®¬ë ˆì´ì…˜ìš©) ê³µê³µ API ë°ì´í„° í˜¸ì¶œ í•¨ìˆ˜
    function fetchDisasterReliefData(address) {
        console.log(`'${address}' ì£¼ì†Œë¡œ ì¬ë‚œì§€ì›ê¸ˆ ë°ì´í„°ë¥¼ ìš”ì²­í•©ë‹ˆë‹¤.`);

        // Promiseë¥¼ ì‚¬ìš©í•´ ë¹„ë™ê¸° API í˜¸ì¶œì„ í‰ë‚´ ëƒ…ë‹ˆë‹¤.
        return new Promise((resolve) => {
            setTimeout(() => {
                // ì‹¤ì œ API ì‘ë‹µê³¼ ìœ ì‚¬í•œ í˜•íƒœì˜ ê°€ì§œ ë°ì´í„°
                const sampleData = [
                    {
                        title: "ê¸´ê¸‰ì¬ë‚œì§€ì›ê¸ˆ",
                        agency: "í–‰ì •ì•ˆì „ë¶€",
                        description: "ì½”ë¡œë‚˜19 ìœ„ê¸° ê·¹ë³µì„ ìœ„í•œ ì „ êµ­ë¯¼ ëŒ€ìƒ ì§€ì›ê¸ˆì…ë‹ˆë‹¤. ê°€êµ¬ ë‹¨ìœ„ë¡œ ì§€ê¸‰ë©ë‹ˆë‹¤."
                    },
                    {
                        title: "ì†Œìƒê³µì¸ ë²„íŒ€ëª©ìê¸ˆ í”ŒëŸ¬ìŠ¤",
                        agency: "ì¤‘ì†Œë²¤ì²˜ê¸°ì—…ë¶€",
                        description: "ì‚¬íšŒì  ê±°ë¦¬ë‘ê¸° ê°•í™”ë¡œ ê²½ì˜ë‚œì„ ê²ªëŠ” ì†Œìƒê³µì¸ì„ ìœ„í•œ ë§ì¶¤í˜• í”¼í•´ ì§€ì› ëŒ€ì±…ì…ë‹ˆë‹¤."
                    },
                    {
                        title: "ì²­ë…„ êµ¬ì§í™œë™ì§€ì›ê¸ˆ",
                        agency: "ê³ ìš©ë…¸ë™ë¶€",
                        description: "ë¯¸ì·¨ì—… ì²­ë…„ì˜ êµ¬ì§í™œë™ì„ ì§€ì›í•˜ì—¬ ì·¨ì—…ì„ ì´‰ì§„í•˜ê¸° ìœ„í•œ ì œë„ì…ë‹ˆë‹¤."
                    }
                ];
                // ì£¼ì†Œì— 'ì„œìš¸'ì´ í¬í•¨ëœ ê²½ìš° íŠ¹ë³„ ì§€ì›ê¸ˆì„ ì¶”ê°€í•˜ëŠ” ì‹œë‚˜ë¦¬ì˜¤
                if (address.includes('ì„œìš¸')) {
                    sampleData.unshift({
                        title: "[ì„œìš¸ì‹œ] ì„œìš¸ í¬ë§ì§€ì›ê¸ˆ",
                        agency: "ì„œìš¸íŠ¹ë³„ì‹œì²­",
                        description: "ì„œìš¸ì‹œë¯¼ì˜ ìƒí™œ ì•ˆì •ì„ ë•ê¸° ìœ„í•´ ì„œìš¸ì‹œì—ì„œ ë³„ë„ë¡œ ì§€ê¸‰í•˜ëŠ” ì¬ë‚œì§€ì›ê¸ˆì…ë‹ˆë‹¤."
                    });
                }

                resolve(sampleData);
            }, 1500); // 1.5ì´ˆ ì§€ì—°ì„ ì‹œë®¬ë ˆì´ì…˜
        });
    }

    // 4. ë°›ì•„ì˜¨ ë°ì´í„°ë¥¼ í™”ë©´ì— ë™ì ìœ¼ë¡œ í‘œì‹œí•˜ëŠ” í•¨ìˆ˜
    function displayResults(data) {
        const resultsList = document.getElementById('results-list');
        resultsList.innerHTML = ''; // ê¸°ì¡´ ë‚´ìš© ì´ˆê¸°í™”

        if (data.length === 0) {
            resultsList.innerHTML = `<div class="alert alert-warning">í•´ë‹¹ ì§€ì—­ì— ëŒ€í•œ ì¬ë‚œì§€ì›ê¸ˆ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.</div>`;
            return;
        }

        data.forEach(item => {
            const cardHTML = `
                <div class="result-card">
                    <h5>${item.title}</h5>
                    <div class="agency">${item.agency}</div>
                    <p>${item.description}</p>
                </div>
            `;
            resultsList.innerHTML += cardHTML;
        });
    }
</script>

</body>
</html>